document.onkeydown=a=>{switch(a.keyCode){case 68:me.walk(-1);break;case 65:me.walk(1);break;case 32:me.jump();}},document.onkeyup=a=>{switch(a.keyCode){case 68:case 65:me.walk(0);}};class Dino{constructor(a,b,d){this.name=b,this.id=a,this.x=d,this.y=0,this.speed=0,this.doublejump=!0,this.bounce=0,this.distance=1,this.width=43,this.height=46,this.north=!0,this.mode=0,this.message=this.randMessage(),this.messageTime=Date.now(),this.color="#2b2b2b"}walk(a){0===a?(this.speed=0,this.mode=0):(this.speed=5*a,this.north=0<a,0===this.mode&&(this.mode=1))}move(){let a=1100;this.x+=this.speed,this.x<=-a?(this.x=-a,this.walk(0)):this.x>=a&&(this.x=a,this.walk(0)),0!==this.speed&&(this.distance+=2/(this.distance/6),(null===lastanimation||100<Date.now()-lastanimation)&&(this.mode++,lastanimation=Date.now(),2<this.mode&&(this.mode=1)))}jump(){0===this.y?(this.doublejump=!0,this.bounce=20):this.doublejump&&(this.doublejump=!1,this.bounce=20)}fall(){this.y+=this.bounce,this.bounce-=1,0>=this.y&&(this.doublejump=!0,this.y=0,this.bounce=0)}randMessage(){let a=["Hello there, my internet doesnt work!","Do you know why I cant play Fortnite?","LOL Minecraft is Offline","I was busy watching some 'educational' videos..","Merhabar, Bir d\xF6ner l\xFCtfen"];return a[Math.floor(Math.random()*a.length)]}}let me,dinos=[],cycleTime=Date.now(),lastanimation=null,dclr="#2b2b2b",c=document.getElementById("c"),ctx=c.getContext("2d");ctx.imageSmoothingEnabled=!1,ctx.fillStyle=dclr,ctx.textAlign="center",ctx.font="20px Arial";let asset=new Image;asset.src="dino.png",socket.on("seed",function(a){init(a)}),socket.on("dinos",function(a){let b=a.map(function(d){return d.id}).indexOf(me.id);-1!==b&&a.splice(b,1),dinos=a});function init(a){me=new Dino(a,"unknown",0),console.log(me),socket.emit("born",me),window.requestAnimationFrame(cycle)}function update(){me.move(),me.fall(),socket.emit("move",me)}function cycle(a){let b=a-cycleTime;update(b),render(),cycleTime=a,window.requestAnimationFrame(cycle)}function toInput(){document.getElementById("in").style.display="block"}function toGame(){document.getElementById("hm").style.display="none",document.getElementById("in").style.display="none",document.getElementById("gm").style.display="block",me.name=document.getElementById("usr").value,me.color=document.getElementById("clr").value}function message(){me.message=document.getElementById("msg").value,me.messageTime=Date.now(),document.getElementById("msg").value=""}function render(){ctx.clearRect(0,0,c.width,c.height),ctx.setTransform(1,0,0,1,0,0),renderFloor(),renderClouds(),renderDinos()}function renderDinos(){let a=me.distance/10,b=5,d=[848,936,980],e=848,f=2,g=43,j=46;1===me.mode?e=d[1]:2===me.mode&&(e=d[2]),ctx.fillStyle=me.color,me.north?(ctx.scale(-1,1),ctx.drawImage(asset,e,f,g,j,-1*(c.width/2-me.width/2)-me.width,c.height-me.height-me.y/2-b,me.width,me.height),ctx.fillRect(-1*(c.width/2-me.width/4+7.5),c.height-me.height-1.2*(me.y/2)-a-b,12,a),ctx.fillRect(-1*(c.width/2-me.width/4+12.5),c.height-me.height-1.2*(me.y/2)-b-4,22,5)):(ctx.drawImage(asset,e,f,g,j,c.width/2-me.width/2,c.height-me.height-me.y/2-b,me.width,me.height),ctx.fillRect(c.width/2-me.width/4+15,c.height-me.height-1.2*(me.y/2)-a-b,12,a),ctx.fillRect(c.width/2-me.width/4+10,c.height-me.height-1.2*(me.y/2)-b-4,22,5)),ctx.setTransform(1,0,0,1,0,0),1e4>=Date.now()-me.messageTime&&(ctx.fillStyle=dclr,ctx.font="15px Arial",ctx.fillText(me.message,c.width/2,c.height-me.height-1.2*(me.y/2)-a-15));for(let l,k=0;k<dinos.length;k++)l=dinos[k],e=848,f=2,1===l.mode?e=d[1]:2===l.mode&&(e=d[2]),ctx.fillStyle=l.color,a=l.distance/10,l.north?(ctx.scale(-1,1),ctx.drawImage(asset,e,f,g,j,-1*(me.x-l.x+(c.width/2-l.width/2))-l.width,c.height-l.height-l.y/2-b,l.width,l.height),ctx.fillRect(-1*(me.x-l.x+(c.width/2-l.width/4)+7.5),c.height-l.height-1.2*(l.y/2)-a-b,12,a),ctx.fillRect(-1*(me.x-l.x+(c.width/2-l.width/4)+12.5),c.height-l.height-1.2*(l.y/2)-b-4,22,5)):(ctx.drawImage(asset,e,f,g,j,me.x-l.x+(c.width/2-l.width/2),c.height-l.height-l.y/2-b,l.width,l.height),ctx.fillRect(me.x-l.x+(c.width/2-l.width/4)+15,c.height-l.height-1.2*(l.y/2)-a-b,12,a),ctx.fillRect(me.x-l.x+(c.width/2-l.width/4)+10,c.height-l.height-1.2*(l.y/2)-b-4,22,5)),ctx.setTransform(1,0,0,1,0,0),ctx.fillStyle=dclr,ctx.font="20px Arial",ctx.fillText(l.name,me.x-l.x+(c.width/2-l.width/4),c.height-l.height-1.2*(l.y/2)-a-30),1e4>=Date.now()-l.messageTime&&(ctx.font="15px Arial",ctx.fillText(l.message,me.x-l.x+(c.width/2-l.width/4),c.height-l.height-1.2*(l.y/2)-a-15))}function renderFloor(){let a=2,b=54,d=1200,e=asset.height-b;ctx.drawImage(asset,a,b,d,e,me.x+c.width/2-d,c.height-e,d,e),ctx.drawImage(asset,a,b,d,e,me.x+c.width/2,c.height-e,d,e)}function renderClouds(){}